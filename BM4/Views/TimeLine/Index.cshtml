@model BM4.Models.TimeLineViewModal

@{
  ViewBag.Title = "Index";
  Layout = "~/Views/Shared/_Layout2.cshtml";
}
<script>
    function RedirectYear(run) {
        var year = @Model.currentYear;
        if (run == 'prev' && @Model.currentYear == @Model.lastYear) {
            return;
        }
        else if(run == 'next' && @Model.currentYear == @Model.firstYear) {
            return;
        }
        else if (run == 'prev')
            var year = @Model.currentYear - 1;
        else if (run == 'next')
            var year = @Model.currentYear + 1;

        window.location = '/Timeline/Index?year=' + year;
    }
</script>
<div class="section inset mt-3">
  <div class="wide-block pt-2 pb-2 pl-2 pr-2 section-title large" style="text-align:center">
    <span class="text-left" style="float:left" onclick="RedirectYear('prev')">
      <i class="icon ion-md-arrow-round-back"></i>
    </span>
    Year @Html.DisplayFor(model => model.currentYear)
    <span class="text-right" style="float:right" onclick="RedirectYear('next')">
      <i class="icon ion-md-arrow-round-forward"></i>
    </span>

  </div>

</div>

@foreach(var item in Model.months)
{
  <div class="section inset mt-3">
    <div class="section-title medium">@Html.DisplayFor(modelItem => item)</div>
    <div class="wide-block pt-2 pb-2">
      @foreach(var events in Model.monthEvents.OrderBy(t => t.startDate))
      {
        if(events.IsInMonth(Model.currentYear, BM4.Code.Constants.MONTHNAMESHORT.IndexOf(item.Split(' ')[0]) + 1))
        {
          <button style="float:right;" type="button" class="btn btn-icon btn-primary mr-1 mb-1" onclick="window.location='/TimeLine/EventDetail?Id=@events.locationId&year=@Model.currentYear&month=@(BM4.Code.Constants.MONTHNAMESHORT.IndexOf(item.Split(' ')[0]) + 1)'">
            <i class="icon ion-md-more"></i>
          </button>
          <h4>@Html.DisplayFor(modelItem => events.location)</h4>
          <h6 style="color:#8195A6">@Html.Raw(events.locationsubheading)</h6>
        }
      }
    </div>
  </div>
}
